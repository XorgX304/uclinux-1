Index: testcases/kernel/syscalls/adjtimex/adjtimex02.c
==================================================================
--- testcases/kernel/syscalls/adjtimex/adjtimex02.c	2005-12-12 17:32:46.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/adjtimex/adjtimex02.c	2005-12-13 11:46:38.000000000 +0800
@@ -115,10 +115,7 @@
 	void (*cleanup)();
 	int exp_errno;
 } test_cases[] = {
-#ifndef UCLINUX
-	/* Ignore this test set for no Protection Mode implemented on uClinux */
 	{ (struct timex *) -1, NULL, NULL, EFAULT },
-#endif
 	{ &buff, setup2, NULL, EINVAL },
 	{ &buff, setup3, NULL, EINVAL },
 	{ &buff, setup4, NULL, EINVAL },
Index: testcases/kernel/syscalls/bind/bind01.c
==================================================================
--- testcases/kernel/syscalls/bind/bind01.c	2005-12-12 17:37:17.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/bind/bind01.c	2005-12-13 11:46:38.000000000 +0800
@@ -76,12 +76,9 @@
 	void	(*cleanup)(void);
 	char *desc;
 } tdat[] = {
-#ifndef UCLINUX
-/* Ignore this test set for no Protection Mode implemented on uClinux */
 	{ PF_INET, SOCK_STREAM, 0, (struct sockaddr *)-1,
 		sizeof(struct sockaddr_in), -1, EFAULT, setup0, cleanup0,
 		"invalid sockaddr" },
-#endif
 	{ PF_INET, SOCK_STREAM, 0, (struct sockaddr *)&sin1,
 		3, -1, EINVAL, setup0, cleanup0,
 		"invalid salen" },
Index: testcases/kernel/syscalls/capget/capget02.c
==================================================================
--- testcases/kernel/syscalls/capget/capget02.c	2005-12-12 17:38:18.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/capget/capget02.c	2005-12-13 11:46:38.000000000 +0800
@@ -107,11 +107,8 @@
 	int exp_errno;
 	char *errdesc;
 } test_cases[] = {
-#ifndef UCLINUX
-	/* Ignore this test set for no Protection Mode implemented on uClinux */
 	{ (cap_user_header_t)-1, &data, EFAULT, "EFAULT" },
 	{ &header, (cap_user_data_t)-1, EFAULT, "EFAULT" },
-#endif
 	{ &header, &data, EINVAL, "EINVAL" },
 	{ &header, &data, EINVAL, "EINVAL" },
 	{ &header, &data, ESRCH, "ESRCH" }
@@ -203,9 +200,6 @@
 void
 test_setup(int i)
 {
-#ifdef UCLINUX
-	i = i+2;
-#endif
 	switch (i) {
 
 	case 0 :
Index: testcases/kernel/syscalls/capset/capset02.c
==================================================================
--- testcases/kernel/syscalls/capset/capset02.c	2005-12-12 17:38:48.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/capset/capset02.c	2005-12-13 11:46:38.000000000 +0800
@@ -118,11 +118,8 @@
 	int exp_errno;
 	char *errdesc;
 } test_cases[] = {
-#ifndef UCLINUX
-	/* Ignore this test set for no Protection Mode implemented on uClinux */
 	{ (cap_user_header_t)-1, &data, EFAULT, "EFAULT" },
 	{ &header, (cap_user_data_t)-1, EFAULT, "EFAULT" },
-#endif
 	{ &header, &data, EINVAL, "EINVAL" },
 	{ &header, &data, EPERM, "EPERM" },
 };
@@ -236,9 +233,9 @@
 void
 test_setup(int i, char *argv0)
 {
-#ifdef UCLINUX
-	i = i+2;
-#endif
+	char nobody_uid[] = "nobody";
+	struct passwd *ltpuser;
+
 	switch (i) {
 
 	case 0 :
@@ -286,6 +283,12 @@
 		default:
 			signal(SIGCHLD,SIG_IGN);
 			header.pid = child_pid;
+			ltpuser = getpwnam(nobody_uid);
+			if (seteuid(ltpuser->pw_uid) == -1) {
+				tst_resm(TBROK,"seteuid() failed: %s\n",strerror(errno));
+			cleanup();
+			}
+
 			break;
 		}
 		break;
Index: testcases/kernel/syscalls/connect/connect01.c
==================================================================
--- testcases/kernel/syscalls/connect/connect01.c	2005-12-12 17:39:27.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/connect/connect01.c	2005-12-13 11:46:38.000000000 +0800
@@ -82,12 +82,9 @@
 	{ PF_INET, SOCK_STREAM, 0, (struct sockaddr *)&sin1,
 		sizeof(struct sockaddr_in), -1, EBADF, setup0, cleanup0,
 		"bad file descriptor" },
-#ifndef UCLINUX
-	/* Ignore this test set for no Protection Mode implemented on uClinux */
 	{ PF_INET, SOCK_STREAM, 0, (struct sockaddr *)-1,
 		sizeof(struct sockaddr_in), -1, EFAULT, setup1, cleanup1,
 		"invalid socket buffer" },
-#endif
 	{ PF_INET, SOCK_STREAM, 0, (struct sockaddr *)&sin1,
 		3, -1, EINVAL, setup1, cleanup1,
 		"invalid salen" },
Index: testcases/kernel/syscalls/fcntl/fcntl13.c
==================================================================
--- testcases/kernel/syscalls/fcntl/fcntl13.c	2005-12-12 17:40:03.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/fcntl/fcntl13.c	2005-12-13 11:46:38.000000000 +0800
@@ -90,8 +90,6 @@
 		tst_resm(TINFO, "Exit block 1");
 
 /* //block2: */
-#ifndef UCLINUX
-		/* Ignore this test set for no Protection Mode implemented on uClinux */
 		tst_resm(TINFO, "Enter block 2");
 		tst_resm(TINFO, "Test for errno EFAULT");
 		fail = 0;
@@ -132,7 +130,6 @@
 			tst_resm(TINFO, "block 2 PASSED");
 		}
 		tst_resm(TINFO, "Exit block 2");
-#endif
 
 /* //block3: */
 		tst_resm(TINFO, "Enter block 3");
Index: testcases/kernel/syscalls/fcntl/fcntl18.c
==================================================================
--- testcases/kernel/syscalls/fcntl/fcntl18.c	2005-12-12 17:40:55.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/fcntl/fcntl18.c	2005-12-13 11:46:38.000000000 +0800
@@ -85,9 +85,6 @@
 	}
 
 	/* Error condition if address is bad */
-#ifndef UCLINUX
-	/* Ignore this test set for no Protection Mode implemented on uClinux */
-	tst_resm(TINFO, "Ignore this test in uClinux");
 	retval = fcntl(fd, F_GETLK, (struct flock *)INVAL_FLAG);
 	if (errno == EFAULT) {
 		tst_resm(TPASS, "Test F_GETLK: for errno EFAULT PASSED");
@@ -100,14 +97,10 @@
 	} else {
 		tst_resm(TINFO, "Block 1 PASSED");
 	}
-#endif
 	tst_resm(TINFO, "Exit block 1");
 
 /* //block2: */
-	tst_resm(TINFO, "Enter block 1");
-#ifndef UCLINUX
-	/* Ignore this test set for no Protection Mode implemented on uClinux */
-	tst_resm(TINFO, "Ignore this test in uClinux");
+	tst_resm(TINFO, "Enter block 2");
 	fail = 0;
 	/* Error condition if address is bad */
 	retval = fcntl(fd, F_GETLK64, (struct flock *)INVAL_FLAG);
@@ -122,7 +115,6 @@
 	} else {
 		tst_resm(TINFO, "Block 2 PASSED");
 	}
-#endif
 	tst_resm(TINFO, "Exit block 2");
 
 /* //block3: */
Index: testcases/kernel/syscalls/fstatfs/fstatfs02.c
==================================================================
--- testcases/kernel/syscalls/fstatfs/fstatfs02.c	2005-12-12 17:41:23.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/fstatfs/fstatfs02.c	2005-12-13 11:46:38.000000000 +0800
@@ -56,11 +56,7 @@
 void cleanup(void);
 
 char *TCID = "fstatfs02";
-#ifdef UCLINUX
-	int TST_TOTAL = 1;
-#else
-	int TST_TOTAL = 2;
-#endif
+int TST_TOTAL = 2;
 extern int Tst_count;
 
 int exp_enos[]={EBADF, EFAULT, 0};
@@ -75,11 +71,8 @@
 	/* EBADF - fd is invalid */
         {-1, &buf, EBADF},
 
-#ifndef UCLINUX
-	/* Ignore this test set on uClinux */
 	/* EFAULT - address for buf is invalid */
         {1, (void *)-1, EFAULT}
-#endif
 };
 
 int main(int ac, char **av)
Index: testcases/kernel/syscalls/getcwd/getcwd01.c
==================================================================
--- testcases/kernel/syscalls/getcwd/getcwd01.c	2005-12-12 17:41:49.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/getcwd/getcwd01.c	2005-12-13 11:46:38.000000000 +0800
@@ -57,11 +57,7 @@
 #include "usctest.h"
 
 char *TCID = "getcwd01";
-#ifdef UCLINUX
-int TST_TOTAL = 3;
-#else
 int TST_TOTAL = 4;
-#endif
 extern int Tst_count;
 char buf[100];
 
@@ -77,10 +73,7 @@
 	int exp_errno;
 	char *exp_retval;
 } testcases[] = {
-#ifndef UCLINUX
-	/* Ignore this test set on uClinux */
 	{ "Test for EFAULT", NULL, (void *)-1, BUFSIZ, EFAULT, NULL },
-#endif
 	{ "Test for ENOMEM", NULL,  NULL, -1, ENOMEM, NULL },
 	{ "Test for EINVAL", NULL, buf, 0, EINVAL, NULL },
 	{ "Test for ERANGE", (void *)setup_test4, buf, 1, ERANGE, NULL }
Index: testcases/kernel/syscalls/getcwd/getcwd02.c
==================================================================
--- testcases/kernel/syscalls/getcwd/getcwd02.c	2005-12-12 17:42:14.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/getcwd/getcwd02.c	2005-12-13 11:46:38.000000000 +0800
@@ -123,10 +123,7 @@
       do_block1();
       do_block2();
       do_block3();
-#ifndef UCLINUX
-      /* Ignore this test set on uClinux */
       do_block4();
-#endif
       do_block5();
       do_block6();
       do_block7();
Index: testcases/kernel/syscalls/getitimer/getitimer02.c
==================================================================
--- testcases/kernel/syscalls/getitimer/getitimer02.c	2005-12-12 17:42:33.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/getitimer/getitimer02.c	2005-12-13 11:46:38.000000000 +0800
@@ -71,8 +71,6 @@
 	int lc;				/* loop counter */
 	char *msg;			/* message returned from parse_opts */
 
-#ifndef UCLINUX
-	tst_resm(TINFO, "Ignore this test in uClinux");
 	/* parse standard options */
 	if ((msg = parse_opts(ac, av, (option_t *)NULL, NULL)) != (char *)NULL){
 		tst_brkm(TBROK, cleanup, "OPTION PARSING ERROR - %s", msg);
@@ -117,8 +115,6 @@
 
 	cleanup();
 
-#endif /* UCLINUX */
-
 	/*NOTREACHED*/
 	return(0);
 }
@@ -155,3 +151,4 @@
 	/* exit with return code appropriate for results */
 	tst_exit();
 }
+
Index: testcases/kernel/syscalls/getpeername/getpeername01.c
==================================================================
--- testcases/kernel/syscalls/getpeername/getpeername01.c	2005-12-12 17:43:01.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/getpeername/getpeername01.c	2005-12-13 11:46:38.000000000 +0800
@@ -89,12 +89,9 @@
 	{ PF_UNIX, SOCK_STREAM, 0, (struct sockaddr *)0,
 		&sinlen, -1, EFAULT, setup2, cleanup1,
 		"invalid socket buffer" },
-#ifndef UCLINUX
-	/* Ignore this test set on uClinux */
 	{ PF_UNIX, SOCK_STREAM, 0, (struct sockaddr *)&fsin1,
 		(int *)1, -1, EFAULT, setup2, cleanup1,
 		"invalid salen" },
-#endif
 };
 
 int TST_TOTAL=sizeof(tdat)/sizeof(tdat[0]); /* Total number of test cases. */
Index: testcases/kernel/syscalls/getrlimit/getrlimit02.c
==================================================================
--- testcases/kernel/syscalls/getrlimit/getrlimit02.c	2005-12-12 17:43:32.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/getrlimit/getrlimit02.c	2005-12-13 11:46:38.000000000 +0800
@@ -79,11 +79,7 @@
 extern int Tst_count;
 
 char *TCID = "getrlimit02";
-#ifdef UCLINUX
-int TST_TOTAL = 1;
-#else
 int TST_TOTAL = 2;
-#endif
 
 static void cleanup(void);
 static void setup(void);
@@ -96,10 +92,7 @@
 	int res_type;		/* resource type 		*/
 	
 } testcases[] = {
-#ifndef UCLINUX
-	/* Ignore this test set on uClinux */
 	{ EFAULT, "EFAULT", (void *)-1, RLIMIT_NOFILE },
-#endif
 	{ EINVAL, "EINVAL", &rlim, RLIMIT_TOO_HIGH }
 };
 
Index: testcases/kernel/syscalls/getrusage/getrusage02.c
==================================================================
--- testcases/kernel/syscalls/getrusage/getrusage02.c	2005-12-12 17:43:57.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/getrusage/getrusage02.c	2005-12-13 11:46:38.000000000 +0800
@@ -92,16 +92,9 @@
 	int exp_errno;
 } test_cases[] ={
 	{ RUSAGE_BOTH, &usage, EINVAL },
-#ifndef UCLINUX
-	/* Ignore this test set on uClinux */
 	{ RUSAGE_SELF, (struct rusage*) -1, EFAULT }
-#endif
 };
-#ifdef UCLINUX
-int TST_TOTAL = 1;
-#else
 int TST_TOTAL = 2;
-#endif
 
 int
 main(int ac, char **av)
Index: testcases/kernel/syscalls/getsockname/getsockname01.c
==================================================================
--- testcases/kernel/syscalls/getsockname/getsockname01.c	2005-12-12 17:44:18.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/getsockname/getsockname01.c	2005-12-13 11:46:38.000000000 +0800
@@ -85,12 +85,9 @@
 	{ PF_INET, SOCK_STREAM, 0, (struct sockaddr *)0,
 		&sinlen, -1, EFAULT, setup1, cleanup1,
 		"invalid socket buffer" },
-#ifndef UCLINUX
-	/* Ignore this test set on uClinux */
 	{ PF_INET, SOCK_STREAM, 0, (struct sockaddr *)&fsin1,
 		(int *)1, -1, EFAULT, setup1, cleanup1,
 		"invalid salen" },
-#endif
 };
 
 int TST_TOTAL=sizeof(tdat)/sizeof(tdat[0]); /* Total number of test cases. */
Index: testcases/kernel/syscalls/gettimeofday/gettimeofday01.c
==================================================================
--- testcases/kernel/syscalls/gettimeofday/gettimeofday01.c	2005-12-12 17:44:37.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/gettimeofday/gettimeofday01.c	2005-12-13 11:46:38.000000000 +0800
@@ -65,9 +65,6 @@
 	int lc;				/* loop counter */
 	char *msg;			/* message returned from parse_opts */
 
-#ifndef UCLINUX
-	/* Ignore this test set on uClinux */
-	tst_resm(TINFO, "Ignore this test in uClinux");
 	/* parse standard options */
 	if ((msg = parse_opts(ac, av, (option_t *)NULL, NULL)) != (char *)NULL){
 		tst_brkm(TBROK, cleanup, "OPTION PARSING ERROR - %s", msg);
@@ -98,7 +95,6 @@
 		}
 	}
 	cleanup();
-#endif /*  UCLINUX  */
 
 	/*NOTREACHED*/
 	return(0);
Index: testcases/kernel/syscalls/read/read02.c
==================================================================
--- testcases/kernel/syscalls/read/read02.c	2005-12-12 17:45:06.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/read/read02.c	2005-12-13 11:46:38.000000000 +0800
@@ -70,11 +70,7 @@
 void setup(void);
 
 char *TCID = "read02";
-#ifdef UCLINUX
-int TST_TOTAL = 2;
-#else
 int TST_TOTAL = 3;
-#endif
 extern int Tst_count;
 
 char file[BUFSIZ];
@@ -97,11 +93,8 @@
 	/* the file descriptor is a directory - EISDIR */
 	{&fd2, buf, EISDIR,},
 
-#ifndef UCLINUX
-	/* Ignore this test set on uClinux */
 	/* the buffer is invalid - EFAULT */
 	{&fd3, (void *)-1, EFAULT}
-#endif
 };
 
 char * bad_addr = 0;
Index: testcases/kernel/syscalls/recv/recv01.c
==================================================================
--- testcases/kernel/syscalls/recv/recv01.c	2005-12-12 17:45:32.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/recv/recv01.c	2005-12-13 11:46:38.000000000 +0800
@@ -84,11 +84,8 @@
 		-1, EBADF, setup0, cleanup0, "bad file descriptor" },
 	{ 0, 0, 0, buf, sizeof(buf), 0,
 		-1, ENOTSOCK, setup0, cleanup0, "invalid socket" },
-#ifndef UCLINUX
-	/* Ignore this test set on uClinux */
 	{ PF_INET, SOCK_STREAM, 0, (void *)-1, sizeof(buf), 0,
 		-1, EFAULT, setup1, cleanup1, "invalid recv buffer" },
-#endif
 	{ PF_INET, SOCK_STREAM, 0, buf, sizeof(buf), -1,
 		-1, EINVAL, setup1, cleanup1, "invalid flags set" },
 };
Index: testcases/kernel/syscalls/sched_rr_get_interval/sched_rr_get_interval03.c
==================================================================
--- testcases/kernel/syscalls/sched_rr_get_interval/sched_rr_get_interval03.c	2005-12-12 17:45:54.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/sched_rr_get_interval/sched_rr_get_interval03.c	2005-12-13 11:46:38.000000000 +0800
@@ -92,10 +92,7 @@
 } test_cases[] = {
 	{ -1, &tp, EINVAL },
 	{ PID_DONT_EXISTS, &tp, ESRCH },
-#ifndef UCLINUX
-	/* Ignore this test set on uClinux */
 	{ 0, (struct timespec *)-1, EFAULT}
-#endif
 };
 
 int TST_TOTAL = sizeof(test_cases) / sizeof(test_cases[0]);
Index: testcases/kernel/syscalls/sched_setscheduler/sched_setscheduler01.c
==================================================================
--- testcases/kernel/syscalls/sched_setscheduler/sched_setscheduler01.c	2005-12-12 17:46:32.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/sched_setscheduler/sched_setscheduler01.c	2005-12-13 11:46:38.000000000 +0800
@@ -62,13 +62,7 @@
 #define INVALID_PID	999999
 
 char *TCID = "sched_setscheduler01";
-
-#ifdef UCLINUX
-int TST_TOTAL = 3;
-#else
 int TST_TOTAL = 4;
-#endif
-
 extern int Tst_count;
 
 struct sched_param param;
@@ -90,11 +84,8 @@
 	/* The policy is invalid - EINVAL */
 	{1, SCHED_INVALID, &param, EINVAL},
 
-#ifndef UCLINUX
-	/* Ignore this test set on uClinux */
 	/* The param address is invalid - EFAULT */
 	{1, SCHED_OTHER, (struct sched_param *)-1, EFAULT},
-#endif
 
 	/* The priority value in param invalid - EINVAL*/
 	{0, SCHED_OTHER, &param1, EINVAL}
Index: testcases/kernel/syscalls/send/send01.c
==================================================================
--- testcases/kernel/syscalls/send/send01.c	2005-12-12 17:47:02.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/send/send01.c	2005-12-13 11:46:38.000000000 +0800
@@ -83,20 +83,14 @@
 		-1, EBADF, setup0, cleanup0, "bad file descriptor" },
 	{ 0, 0, 0, buf, sizeof(buf), 0,
 		-1, ENOTSOCK, setup0, cleanup0, "invalid socket" },
-#ifndef UCLINUX
-	/* Ignore this test set on uClinux */
 	{ PF_INET, SOCK_STREAM, 0, (void *)-1, sizeof(buf), 0,
 		-1, EFAULT, setup1, cleanup1, "invalid send buffer" },
-#endif
 	{ PF_INET, SOCK_DGRAM, 0, bigbuf, sizeof(bigbuf), 0,
 		-1, EMSGSIZE, setup1, cleanup1, "UDP message too big" },
 	{ PF_INET, SOCK_STREAM, 0, buf, sizeof(buf), 0,
 		-1, EPIPE, setup2, cleanup1, "local endpoint shutdown" },
-#ifndef UCLINUX
-	/* Ignore this test set on uClinux */
 	{ PF_INET, SOCK_STREAM, 0, (void *)-1, sizeof(buf), -1,
 		-1, EFAULT, setup1, cleanup1, "invalid flags set" },
-#endif
 };
 
 int TST_TOTAL=sizeof(tdat)/sizeof(tdat[0]); /* Total number of test cases. */
Index: testcases/kernel/syscalls/sendto/sendto01.c
==================================================================
--- testcases/kernel/syscalls/sendto/sendto01.c	2005-12-12 17:47:29.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/sendto/sendto01.c	2005-12-13 11:46:38.000000000 +0800
@@ -86,24 +86,18 @@
 		-1, EBADF, setup0, cleanup0, "bad file descriptor" },
 	{ 0, 0, 0, buf, sizeof(buf), 0, &sin1, sizeof(sin1),
 		-1, ENOTSOCK, setup0, cleanup0, "invalid socket" },
-#ifndef UCLINUX
-	/* Ignore this test set on uClinux */
 	{ PF_INET, SOCK_DGRAM, 0, (void *)-1, sizeof(buf), 0, &sin1,
 		sizeof(sin1),
 		-1, EFAULT, setup1, cleanup1, "invalid send buffer" },
-#endif
 	{ PF_INET, SOCK_STREAM, 0, buf, sizeof(buf), 0, &sin2, sizeof(sin2),
 		 0, EFAULT, setup1, cleanup1, "connected TCP" },
 	{ PF_INET, SOCK_STREAM, 0, buf, sizeof(buf), 0, &sin1, sizeof(sin1),
 		-1, EPIPE, setup3, cleanup1, "not connected TCP" },
 	{ PF_INET, SOCK_DGRAM, 0, buf, sizeof(buf), 0, &sin1, -1,
 		-1, EINVAL, setup1, cleanup1, "invalid to buffer length" },
-#ifndef UCLINUX
-	/* Ignore this test set on uClinux */
 	{ PF_INET, SOCK_DGRAM, 0, buf, sizeof(buf), 0, (struct sockaddr_in *)-1,
 		sizeof(sin1),
 		-1, EFAULT, setup1, cleanup1, "invalid to buffer" },
-#endif
 	{ PF_INET, SOCK_DGRAM, 0, bigbuf, sizeof(bigbuf), 0, &sin1,
 		sizeof(sin1),
 		-1, EMSGSIZE, setup1, cleanup1, "UDP message too big" },
Index: testcases/kernel/syscalls/sethostname/sethostname02.c
==================================================================
--- testcases/kernel/syscalls/sethostname/sethostname02.c	2005-12-12 17:47:51.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/sethostname/sethostname02.c	2005-12-13 11:46:38.000000000 +0800
@@ -92,11 +92,7 @@
 static void setup(void);
 
 char *TCID = "sethostname02";
-#ifdef UCLINUX
-int TST_TOTAL = 2;
-#else
 int TST_TOTAL = 3;
-#endif
 static char hostname[MAX_LENGTH];
 static char hname[MAX_LENGTH];
 static char largehost[LARGE_LENGTH];
@@ -110,10 +106,7 @@
 	{ "Length is -ve", EINVAL, "EINVAL", hostname, -1 },
 	{ "Length > max allowed size", EINVAL, "EINVAL", largehost, 
 		sizeof(largehost)},
-#ifndef UCLINUX
-	/* Ignore this test on uClinux */
 	{ "Invalid address ", EFAULT, "EFAULT", (void *)-1, sizeof(hostname)}
-#endif
 };
 
 static int exp_enos[] = {EINVAL, EINVAL, EFAULT, 0};
Index: testcases/kernel/syscalls/setitimer/setitimer02.c
==================================================================
--- testcases/kernel/syscalls/setitimer/setitimer02.c	2005-12-12 17:48:16.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/setitimer/setitimer02.c	2005-12-13 11:46:38.000000000 +0800
@@ -73,8 +73,6 @@
 	char *msg;			/* message returned from parse_opts */
 	struct itimerval *value;
 
-#ifndef UCLINUX
-	tst_resm(TINFO, "Ignore this test on uClinux");
 	/* parse standard options */
 	if ((msg = parse_opts(ac, av, (option_t *)NULL, NULL)) != (char *)NULL){
 		tst_brkm(TBROK, tst_exit, "OPTION PARSING ERROR - %s", msg);
@@ -137,7 +135,6 @@
 	cleanup();
 
 	/*NOTREACHED*/
-#endif /* UCLINUX */
 
   return(0);
 
Index: testcases/kernel/syscalls/settimeofday/settimeofday01.c
==================================================================
--- testcases/kernel/syscalls/settimeofday/settimeofday01.c	2005-12-12 17:48:37.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/settimeofday/settimeofday01.c	2005-12-13 11:46:38.000000000 +0800
@@ -82,8 +82,6 @@
 	char *msg;			/* message returned from parse_opts */
 	suseconds_t delta;
 
-#ifndef UCLINUX
-	/* Ignore this test on uClinux */
 	/* parse standard options */
 	if ((msg = parse_opts(argc, argv, (option_t *)NULL, NULL)) !=
 	    (char *)NULL) {
@@ -143,7 +141,6 @@
 	}
 	cleanup();
 	/*NOTREACHED*/
-#endif
 
   return(0);
 
Index: testcases/kernel/syscalls/settimeofday/settimeofday02.c
==================================================================
--- testcases/kernel/syscalls/settimeofday/settimeofday02.c	2005-12-12 17:49:30.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/settimeofday/settimeofday02.c	2005-12-13 11:46:38.000000000 +0800
@@ -86,8 +86,6 @@
 	int lc;				/* loop counter */
 	char *msg;			/* message returned from parse_opts */
 
-#ifndef UCLINUX
-	/* Ignore this test on uClinux */
 	/* parse standard options */
 	if ((msg = parse_opts(argc, argv, (option_t *)NULL, NULL)) !=
 	    (char *)NULL) {
@@ -133,7 +131,6 @@
 	}
 	cleanup();
 	/*NOTREACHED*/
-#endif /* UCLINUX */
 
   return(0);
 
Index: testcases/kernel/syscalls/socketpair/socketpair01.c
==================================================================
--- testcases/kernel/syscalls/socketpair/socketpair01.c	2005-12-12 17:49:51.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/socketpair/socketpair01.c	2005-12-13 11:46:38.000000000 +0800
@@ -75,17 +75,12 @@
 	{ PF_INET, 75, 0, sv, -1, EINVAL, "invalid type" },
 	{ PF_UNIX, SOCK_DGRAM, 0, sv, 0, 0, "UNIX domain dgram" },
 	{ PF_INET, SOCK_RAW, 0, sv, -1, ESOCKTNOSUPPORT, "raw open as non-root" },
-#ifndef UCLINUX
-	/* Ignore this test on uClinux */
 	{ PF_UNIX, SOCK_STREAM, 0, 0, -1, EFAULT, "bad pointer" },
 	{ PF_UNIX, SOCK_STREAM, 0, (int *)7, -1, EFAULT, "bad pointer" },
-#endif
-	/*
 	{ PF_INET, SOCK_DGRAM, 17, sv, -1, EOPNOTSUPP, "UDP socket" },
 	{ PF_INET, SOCK_DGRAM, 6, sv, -1, ESOCKTNOSUPPORT, "TCP dgram" },
 	{ PF_INET, SOCK_STREAM, 6, sv, -1, EOPNOTSUPP, "TCP socket" },
 	{ PF_INET, SOCK_STREAM, 1, sv, -1, ESOCKTNOSUPPORT, "ICMP stream" },
-	*/
 };
 
 int TST_TOTAL=sizeof(tdat)/sizeof(tdat[0]); /* Total number of test cases. */
Index: testcases/kernel/syscalls/statfs/statfs02.c
==================================================================
--- testcases/kernel/syscalls/statfs/statfs02.c	2005-12-12 17:50:22.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/statfs/statfs02.c	2005-12-13 11:46:38.000000000 +0800
@@ -62,11 +62,7 @@
 #include "usctest.h"
 
 char *TCID = "statfs02";
-#ifdef UCLINUX
-int TST_TOTAL = 3;
-#else
 int TST_TOTAL = 5;
-#endif
 int fileHandle = 0;
 extern int Tst_count;
 
@@ -94,14 +90,11 @@
 	/* path is too long - ENAMETOOLONG */
 	{bad_file, &fsbuf, ENAMETOOLONG},
 
-#ifndef UCLINUX
-	/* Ignore this test on uClinux */
 	/* path is an invalid address - EFAULT */
 	{(char *)-1, &fsbuf, EFAULT},
 
 	/* buf is an invalid address - EFAULT */
 	{fname, (struct statfs *)-1, EFAULT}
-#endif
 };
 
 void setup(void);
Index: testcases/kernel/syscalls/sysctl/sysctl05.c
==================================================================
--- testcases/kernel/syscalls/sysctl/sysctl05.c	2005-12-12 17:50:45.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/sysctl/sysctl05.c	2005-12-13 11:46:38.000000000 +0800
@@ -107,8 +107,6 @@
 	int i;
 	int ret;
 
-#ifndef UCLINUX
-	tst_resm(TINFO, "Ignore this test on uClinux");
 	/* parse standard options */
 	if ((msg = parse_opts(ac, av, (option_t *)NULL, NULL)) != (char *)NULL){
 		tst_brkm(TBROK, tst_exit, "OPTION PARSING ERROR - %s", msg);
@@ -157,7 +155,6 @@
 		}
 	}
 	cleanup();
-#endif
 
 	/*NOTREACHED*/
 	return(0);
Index: testcases/kernel/syscalls/sysinfo/sysinfo02.c
==================================================================
--- testcases/kernel/syscalls/sysinfo/sysinfo02.c	2005-12-12 17:51:03.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/sysinfo/sysinfo02.c	2005-12-13 11:46:38.000000000 +0800
@@ -82,8 +82,6 @@
 int
 main(int ac, char **av)
 {
-#ifndef UCLINUX
-	/* Ignore this test on uClinux */
 	struct sysinfo *sysinfo_buf;
 	int lc;
 	char *msg;
@@ -121,7 +119,6 @@
 	}
 	cleanup();
 	/*NOTREACHED*/
-#endif
 
   return(0);
 
Index: testcases/kernel/syscalls/times/times02.c
==================================================================
--- testcases/kernel/syscalls/times/times02.c	2005-12-12 17:51:25.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/times/times02.c	2005-12-13 11:46:38.000000000 +0800
@@ -60,8 +60,6 @@
 
 int main(int argc, char **argv)
 {
-#ifndef UCLINUX
-	tst_resm(TINFO, "Ignore this test on uClinux");
 	int lc;				/* loop counter */
 	char *msg;			/* message returned from parse_opts */
 
@@ -96,7 +94,6 @@
 	}
 	cleanup();
 	/*NOTREACHED*/
-#endif
 
   return(0);
 
Index: testcases/kernel/syscalls/uname/uname02.c
==================================================================
--- testcases/kernel/syscalls/uname/uname02.c	2005-12-12 17:51:41.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/uname/uname02.c	2005-12-13 11:46:38.000000000 +0800
@@ -68,8 +68,6 @@
 
 int main(int ac, char **av)
 {
-#ifndef UCLINUX
-	tst_resm(TINFO, "Ignore this test on uClinux");
 	int lc;				/* loop counter */
 	char *msg;			/* message returned from parse_opts */
 
@@ -114,7 +112,6 @@
 	}
 
 	cleanup();
-#endif
 
 	/*NOTREACHED*/
 
Index: testcases/kernel/syscalls/ustat/ustat02.c
==================================================================
--- testcases/kernel/syscalls/ustat/ustat02.c	2005-12-09 16:02:14.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/ustat/ustat02.c	2005-12-13 11:46:38.000000000 +0800
@@ -79,11 +79,7 @@
 static void cleanup();
 
 char *TCID = "ustat02"; 	/* Test program identifier.    */
-#ifdef UCLINUX
-int TST_TOTAL = 1;
-#else
 int TST_TOTAL = 2;       	/* Total number of test cases. */
-#endif
 extern int Tst_count;    	/* Test Case counter for tst_* routines */
 
 static int exp_enos[] = {EINVAL, EFAULT, 0};
Index: testcases/kernel/syscalls/write/write03.c
==================================================================
--- testcases/kernel/syscalls/write/write03.c	2005-12-12 17:53:00.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/write/write03.c	2005-12-13 11:46:38.000000000 +0800
@@ -71,8 +71,6 @@
 
 int main(int argc, char **argv)
 {
-#ifndef UCLINUX
-	tst_resm(TINFO, "Ignore this test on uClinux");
 	int lc;				/* loop counter */
 	char *msg;			/* message returned from parse_opts */
 
@@ -145,7 +143,6 @@
 	}
 	cleanup();
 	/*NOTREACHED*/
-#endif /* UCLINUX */
 	return(0);
 }
 
Index: testcases/kernel/syscalls/write/write05.c
==================================================================
--- testcases/kernel/syscalls/write/write05.c	2005-12-12 17:53:21.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/write/write05.c	2005-12-13 11:46:38.000000000 +0800
@@ -112,8 +112,6 @@
 		}
 		tst_resm(TINFO, "Exit Block 1");
 
-#ifndef UCLINUX
-		/* Ignore this test on uClinux */
 //block2:
 		tst_resm(TINFO, "Enter Block 2: test with a bad address");
 		fd = creat(filename, 0644);
@@ -139,7 +137,6 @@
 			tst_resm(TPASS, "received EFAULT as expected.");
 		}
 		tst_resm(TINFO, "Exit Block 2");
-#endif
 
 //block3:
 		tst_resm(TINFO, "Enter Block 3: test with invalid pipe");
Index: testcases/kernel/syscalls/write/writev01.c
==================================================================
--- testcases/kernel/syscalls/writev/writev01.c	2005-12-12 17:53:47.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/writev/writev01.c	2005-12-13 11:46:38.000000000 +0800
@@ -199,6 +199,7 @@
 			cleanup();
 			/*NOTREACHED*/
 		}
+
 //block1: /* given vector length -1, writev() return EINVAL. */
 		tst_resm(TINFO, "Enter Block 1");
 		fail = 0;
@@ -224,8 +225,6 @@
 		}
 		tst_resm(TINFO, "Exit block 1");
 
-#ifndef UCLINUX
-		/* Ignore this test on uClinux */
 //block2:
 	/* This testcases doesn't look like what it intent to do
         * 1. it is not using the wr_iovec initialized 
@@ -269,10 +268,7 @@
 			tst_resm(TINFO, "block 2 PASSED");
 		}
 		tst_resm(TINFO, "Exit block 2");
-#endif
 
-#ifndef UCLINUX
-		/* Ignore this test on uClinux */
 //block3: /* given 1 bad vector buffer with good ones, writev() success */
 		tst_resm(TINFO, "Enter block 3");
 		fail = 0;
@@ -313,7 +309,6 @@
 			tst_resm(TINFO, "block 3 PASSED");
 		}
 		tst_resm(TINFO, "Exit block 3");
-#endif
 
 //block4: /* given bad file discriptor, writev() return EBADF. */
 		tst_resm(TINFO, "Enter block 4");
Index: testcases/kernel/syscalls/write/writev02.c
==================================================================
--- testcases/kernel/syscalls/writev/writev02.c	2005-12-12 17:54:05.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/writev/writev02.c	2005-12-13 11:46:38.000000000 +0800
@@ -96,8 +96,6 @@
 
 int main(int argc, char **argv)
 {
-#ifndef UCLINUX
-	tst_resm(TINFO, "Ignore this test on uClinux");
 	int lc;				/* loop counter */
 	char *msg;			/* message returned from parse_opts */
 
@@ -220,7 +218,6 @@
 		tst_resm(TINFO, "Exit block 1");
 	}
 	cleanup();
-#endif /* UCLINUX */
 	return(0);
 }
 
Index: testcases/kernel/syscalls/write/writev03.c
==================================================================
--- testcases/kernel/syscalls/writev/writev03.c	2005-12-12 17:54:29.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/writev/writev03.c	2005-12-13 11:46:38.000000000 +0800
@@ -45,8 +45,10 @@
  */
 
 #include <sys/types.h>
-#include <signal.h>
 #include <sys/uio.h>
+#include <sys/mman.h>
+#include <unistd.h>
+#include <signal.h>
 #include <fcntl.h>
 #include <memory.h>
 #include <errno.h>
@@ -61,6 +63,7 @@
 #define	DATA_FILE	"writev_data_file"
 
 char	buf1[K_1], buf2[K_1], buf3[K_1];
+char*	bad_addr = 0;
 
 struct iovec wr_iovec[MAX_IOVEC] = {
 	/* testcase #1 */
@@ -89,8 +92,6 @@
 
 int main(int argc, char **argv)
 {
-#ifndef UCLINUX
-	/* Ignore this test on uClinux */
 	int lc;				/* loop counter */
 	char *msg;			/* message returned from parse_opts */
 
@@ -269,7 +270,6 @@
 		tst_resm(TINFO, "Exit block 3");
 	}
 	cleanup();
-#endif
 	return(0);
 }
 
@@ -295,7 +295,12 @@
 
 	strcpy(name, DATA_FILE);
 	sprintf(f_name, "%s.%d", name, getpid());
-
+	
+	bad_addr = mmap(0, 1, PROT_NONE, MAP_PRIVATE|MAP_ANONYMOUS, 0, 0);
+	if (bad_addr <= 0) {
+		tst_brkm(TBROK, cleanup, "mmap failed");
+	}
+	wr_iovec[1].iov_base = bad_addr;
 	tst_tmpdir();
 }
 
Index: testcases/kernel/syscalls/write/writev04.c
==================================================================
--- testcases/kernel/syscalls/writev/writev04.c	2005-12-12 17:54:41.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/writev/writev04.c	2005-12-13 11:46:38.000000000 +0800
@@ -44,10 +44,11 @@
  * Restrictions
  *	NONE
  */
-
 #include <sys/types.h>
-#include <signal.h>
 #include <sys/uio.h>
+#include <sys/mman.h>
+#include <unistd.h>
+#include <signal.h>
 #include <fcntl.h>
 #include <memory.h>
 #include <errno.h>
@@ -62,6 +63,7 @@
 #define	DATA_FILE	"writev_data_file"
 
 char	buf1[K_1], buf2[K_1], buf3[K_1];
+char*	bad_addr = 0;
 
 struct iovec wr_iovec[MAX_IOVEC] = {
 	/* testcase #1 */
@@ -90,8 +92,6 @@
 
 int main(int argc, char **argv)
 {
-#ifndef UCLINUX
-	/* Ignore this test on uClinux */
 	int lc;				/* loop counter */
 	char *msg;			/* message returned from parse_opts */
 
@@ -279,7 +279,6 @@
 		tst_resm(TINFO, "Exit block 3");
 	}
 	cleanup();
-#endif /* UCLINUX */
 	return(0);
 }
 
@@ -304,6 +303,12 @@
 
 	strcpy(name, DATA_FILE);
 	sprintf(f_name, "%s.%d", name, getpid());
+	
+        bad_addr = mmap(0, 1, PROT_NONE, MAP_PRIVATE|MAP_ANONYMOUS, 0, 0);
+        if (bad_addr <= 0) {
+                tst_brkm(TBROK, cleanup, "mmap failed");
+        }
+        wr_iovec[1].iov_base = bad_addr;
 
 }
 
Index: testcases/kernel/syscalls/write/writev05.c
==================================================================
--- testcases/kernel/syscalls/writev/writev05.c	2005-12-12 17:54:57.000000000 +0800
+++ ltp-full-20051205.org/testcases/kernel/syscalls/writev/writev05.c	2005-12-13 11:46:38.000000000 +0800
@@ -91,8 +91,6 @@
 
 int main(int argc, char **argv)
 {
-#ifndef UCLINUX
-	/* Ignore this test on uClinux */
 	int lc;				/* loop counter */
 	char *msg;			/* message returned from parse_opts */
 
@@ -205,7 +203,6 @@
 		tst_resm(TINFO, "Exit block 1");
 	}
 	cleanup();
-#endif /* UCLINUX */
 	return(0);
 }
 
